---
title: Heart Desease Prediction
description: Kaggle의 Heart Desease Prediction 데이터셋을 활용한 심장병 예측
thumbnail: https://imagedelivery.net/6qzLODAqs2g1LZbVYqtuQw/9e9cfb2b-4252-4738-3a9c-4882a248a800/public
prerequisites:
  ['우원', 'FE Developer', 'FE Developer', '안녕하세요! 우원입니다.']
stacks: ['KAGGLE']
writer: 우원
date: '2023-07-19'
name: '20230719_1'
lock: 'false'
---

# Heart Desease Prediction

## 1. 데이터셋 출처

- 데이터셋 출처 : [Kaggle](https://www.kaggle.com/datasets/rashikrahmanpritom/heart-attack-analysis-prediction-dataset)

## 2. 데이터셋 설명

정말 유명한 데이터셋입니다.
추천 수가 3000이 넘어가고 제출된 분석 코드 수만 1000개가 넘습니다.

## 3. 데이터셋 분석

시작하기 전에 데이터셋이 준비되어 있어야합니다.
데이터를 실제로 확인하고 싶으시다면 캐글에서 데이터셋을 다운로드 받으시면 됩니다.

### 1) Variables

| Variable | info                                                                                                     |
| :------: | -------------------------------------------------------------------------------------------------------- |
|   age    | Age of the patient(환자의 나이)                                                                          |
|   sex    | Sex of the patient(환자의 성별)                                                                          |
|  exang   | exercise induced angina (1 = yes; 0 = no)                                                                |
|          | (협심증이 운동으로 유발되는지 여부)                                                                      |
|    ca    | number of major vessels (0-3)(주요 혈관의 수)                                                            |
|    cp    | Chest Pain type chest pain type(가슴 통증 유형)                                                          |
|          | Value 1: typical angina(일반적인/전형적인 협심증 유형)                                                   |
|          | Value 2: atypical angina(예외적인/비전형적인 협심증 유형)                                                |
|          | Value 3: non-anginal pain(협심증 아닌 통증 유형)                                                         |
|          | Value 4: asymptomatic(무증상)                                                                            |
|  trtbps  | resting blood pressure (in mm Hg)                                                                        |
|          | (안정된 상태의 혈압)(mmHg => 수은주 밀리미터)                                                            |
|   chol   | cholestoral in mg/dl fetched via BMI sensor                                                              |
|          | (BMI 센서를 통해 가져온 콜레스테롤 수치)                                                                 |
|          | (mg/dl => 밀리그램/데시리터)                                                                             |
|   fbs    | (fasting blood sugar > 120 mg/dl) (1 = true; 0 = false)                                                  |
|          | (공복 혈당)                                                                                              |
| rest_ecg | resting electrocardiographic results(안정시 심전도 결과)                                                 |
|          | Value 0: normal(일반적인 경우)                                                                           |
|          | Value 1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of > 0.05 mV) |
|          | (ST-T파 이상이 있는 경우)                                                                                |
|          | Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria                    |
| thalach  | maximum heart rate achieved(최대 심박수)                                                                 |
|  target  | 0= less chance of heart attack                                                                           |
|          | 1= more chance of heart attack                                                                           |

### 2) Preparation

#### 2.1 Packages

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
```

#### 2.2 Data

```python
df = pd.read_csv("/Downloads/heart-attack/heart.csv")
```

#### 2.3 Shape

```python
print("데이터 (행의 수, 차원의 수) : ", df.shape)
데이터 (행의 수, 차원의 수) : (303, 14)
df.head()
```

|     | age | sex | cp  | trtbps | chol | fbs | restecg | thalachh | exng | oldpeak | slp | caa | thall | output |
| :-: | :-: | :-: | :-: | :----: | :--: | :-: | :-----: | :------: | :--: | :-----: | :-: | :-: | ----- | ------ |
|  0  | 63  |  1  |  3  |  145   | 233  |  1  |    0    |   150    |  0   |   2.3   |  0  |  0  | 1     | 1      |
|  1  | 37  |  1  |  2  |  130   | 250  |  0  |    1    |   187    |  0   |   3.5   |  0  |  0  | 2     | 1      |
|  2  | 41  |  0  |  1  |  130   | 204  |  0  |    0    |   172    |  0   |   1.4   |  2  |  0  | 2     | 1      |
|  3  | 56  |  1  |  1  |  120   | 236  |  0  |    1    |   178    |  0   |   0.8   |  2  |  0  | 2     | 1      |
|  4  | 57  |  0  |  0  |  120   | 354  |  0  |    1    |   163    |  1   |   0.6   |  2  |  0  | 2     | 1      |

추가로 각각의 컬럼별로 고유값의 개수를 체크합니다.

```python
dic = {}
for i in list(df.columns):
  dic[i] = df[i].value_counts().shape[0]

pd.DataFrame(dic, index=["unique count"]).transpose()
```

|  unique  | count |
| :------: | ----- |
|   age    | 41    |
|   sex    | 2     |
|    cp    | 4     |
|  trtbps  | 49    |
|   chol   | 152   |
|   fbs    | 2     |
| restecg  | 3     |
| thalachh | 91    |
|   exng   | 2     |
| oldpeak  | 40    |
|   slp    | 3     |
|   caa    | 5     |
|  thall   | 4     |
|  output  | 2     |

이제 중요한 작업을 해줘야합니다.
바로 범주형 변수와 연속형 변수를 구분하는 것입니다.

```python
# 범주형 변수
cat_cols = ["sex","exng","caa","cp","fbs","restecg","slp","thall"]
# 연속형 변수
con_cols = ["age","trtbps","chol","thalachh","oldpeak"]

target_col = ["output"]

print("범주형: ", cat_cols)
print("연속형: ", con_cols)
print("목표변수(종속변수): ", target_col)
```

```python
The categorial cols are : ['sex', 'exng', 'caa', 'cp', 'fbs', 'restecg', 'slp', 'thall']
The continuous cols are : ['age', 'trtbps', 'chol', 'thalachh', 'oldpeak']
The target variable is : ['output']
```

연속형 변수의 기초통계량 정보를 확인합니다.

```python
df[con_cols].describe().transpose()
```

|          | count |    mean    |    std    |  min  |  25%  |  50%  |  75%  | max   |
| :------: | :---: | :--------: | :-------: | :---: | :---: | :---: | :---: | ----- |
|   age    | 303.0 | 54.366337  | 9.082101  | 29.0  | 47.5  | 55.0  | 61.0  | 77.0  |
|  trtbps  | 303.0 | 131.623762 | 17.538143 | 94.0  | 120.0 | 130.0 | 140.0 | 200.0 |
|   chol   | 303.0 | 246.264026 | 51.830751 | 126.0 | 211.0 | 240.0 | 274.5 | 564.0 |
| thalachh | 303.0 | 149.646865 | 22.905161 | 71.0  | 133.5 | 153.0 | 166.0 | 202.0 |
| oldpeak  | 303.0 |  1.039604  | 1.161075  |  0.0  |  0.0  |  0.8  |  1.6  | 6.2   |

마지막으로 결측값을 확인합니다.

```python
df.isnull().sum()
```

|   variable   | count |
| :----------: | :---: |
|     age      |   0   |
|     sex      |   0   |
|      cp      |   0   |
|    trtbps    |   0   |
|     chol     |   0   |
|     fbs      |   0   |
|   restecg    |   0   |
|   thalachh   |   0   |
|     exng     |   0   |
|   oldpeak    |   0   |
|     slp      |   0   |
|     caa      |   0   |
|    thall     |   0   |
|    output    |   0   |
| dtype: int64 |   -   |

### 2) EDA(탐색적 데이터 분석)

```python
fig = plt.figure(figsize=(18,15))
gs = fig.add_gridspec(3,3)
gs.update(wspace=0.5, hspace=0.25)
ax0 = fig.add_subplot(gs[0,0])
ax1 = fig.add_subplot(gs[0,1])
ax2 = fig.add_subplot(gs[0,2])
ax3 = fig.add_subplot(gs[1,0])
ax4 = fig.add_subplot(gs[1,1])
ax5 = fig.add_subplot(gs[1,2])
ax6 = fig.add_subplot(gs[2,0])
ax7 = fig.add_subplot(gs[2,1])
ax8 = fig.add_subplot(gs[2,2])

background_color = "#ffffff"
color_palette = ["#D04848","#F3B95F","#FDE767","#6895D2","#da8829"]
fig.patch.set_facecolor(background_color) 
ax0.set_facecolor(background_color) 
ax1.set_facecolor(background_color) 
ax2.set_facecolor(background_color) 
ax3.set_facecolor(background_color) 
ax4.set_facecolor(background_color) 
ax5.set_facecolor(background_color) 
ax6.set_facecolor(background_color) 
ax7.set_facecolor(background_color) 
ax8.set_facecolor(background_color) 

# Title of the plot
ax0.spines["bottom"].set_visible(False)
ax0.spines["left"].set_visible(False)
ax0.spines["top"].set_visible(False)
ax0.spines["right"].set_visible(False)
ax0.tick_params(left=False, bottom=False)
ax0.set_xticklabels([])
ax0.set_yticklabels([])
ax0.text(0.5,0.5,
         'Count plot for various\n categorical features\n_________________',
         horizontalalignment='center',
         verticalalignment='center',
         fontsize=18, fontweight='bold',
         fontfamily='serif',
         color="#000000")

# Sex count
ax1.text(0.3, 220, 'Sex', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax1.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax1,data=df,x='sex',palette=color_palette)
ax1.set_xlabel("")
ax1.set_ylabel("")

# Exng count
ax2.text(0.3, 220, 'Exng', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax2.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax2,data=df,x='exng',palette=color_palette)
ax2.set_xlabel("")
ax2.set_ylabel("")

# Caa count
ax3.text(1.5, 200, 'Caa', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax3.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax3,data=df,x='caa',palette=color_palette)
ax3.set_xlabel("")
ax3.set_ylabel("")

# Cp count
ax4.text(1.5, 162, 'Cp', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax4.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax4,data=df,x='cp',palette=color_palette)
ax4.set_xlabel("")
ax4.set_ylabel("")

# Fbs count
ax5.text(0.5, 290, 'Fbs', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax5.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax5,data=df,x='fbs',palette=color_palette)
ax5.set_xlabel("")
ax5.set_ylabel("")

# Restecg count
ax6.text(0.75, 165, 'Restecg', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax6.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax6,data=df,x='restecg',palette=color_palette)
ax6.set_xlabel("")
ax6.set_ylabel("")

# Slp count
ax7.text(0.85, 155, 'Slp', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax7.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax7,data=df,x='slp',palette=color_palette)
ax7.set_xlabel("")
ax7.set_ylabel("")

# Thall count
ax8.text(1.2, 180, 'Thall', fontsize=14, fontweight='bold', fontfamily='serif', color="#000000")
ax8.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax8,data=df,x='thall',palette=color_palette)
ax8.set_xlabel("")
ax8.set_ylabel("")

for s in ["top","right","left"]:
    ax1.spines[s].set_visible(False)
    ax2.spines[s].set_visible(False)
    ax3.spines[s].set_visible(False)
    ax4.spines[s].set_visible(False)
    ax5.spines[s].set_visible(False)
    ax6.spines[s].set_visible(False)
    ax7.spines[s].set_visible(False)
    ax8.spines[s].set_visible(False)

```


![범주형 변수 도수 분포표](https://imagedelivery.net/6qzLODAqs2g1LZbVYqtuQw/1b632f97-1f31-4477-48ad-f4e82df78900/public)