---
title: Matter.jsë¡œ ë¬¼ë¦¬ì—”ì§„ êµ¬í˜„í•˜ê¸°
description: WMC ì¸ë±ìŠ¤ í˜ì´ì§€ì— Matter.jsë¥¼ ì´ìš©í•´ ë¬¼ë¦¬ì—”ì§„ì„ êµ¬í˜„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.
thumbnail: /assets/matterjs.png
prerequisites: ['ìš°ì›', 'ì£¼ë‹ˆì–´ ê°œë°œì','ì„±ì¥ ì¤‘','ì•ˆë…•í•˜ì„¸ìš”ğŸ‘ ì¹¨ì°©í•¨ê³¼ ê¾¸ì¤€í•¨ì´ ë§¤ë ¥ì¸ ì£¼ë‹ˆì–´ ê°œë°œì ìš°ì›ì…ë‹ˆë‹¤.']
stacks: ['REACT']
writer: ìš°ì›
date: '2023-01-10'
name: '20230110_1' 
---

# ğŸ Matter.jsë¡œ ë¬¼ë¦¬ì—”ì§„ êµ¬í˜„í•˜ê¸°

WMC ì¸ë±ìŠ¤ í˜ì´ì§€ë¥¼ êµ¬ì„±í•˜ë©´ì„œ Matter.jsë¥¼ ì´ìš©í•´ ë„í˜•ì´ ìŠ¤í¬ë¡¤ì˜ interactionì„ í†µí•´ ì›€ì§ì´ëŠ” ë¬¼ë¦¬ì—”ì§„ì„ êµ¬í˜„í•´ë³´ì•˜ë‹¤.
IntersectionObserverë¥¼ í™œìš©í•´ thresholdê°€ 0.8ì¼ ë•Œ Opacityê°€ 1ì´ ë˜ê³  
ë„í˜•ë“¤ì´ canvasì— ë Œë”ë§ë˜ì–´ ë‚™í•˜ìš´ë™ì„ í•˜ëŠ” ê²ƒì„ êµ¬í˜„í–ˆë‹¤.
ë§‰ìƒ êµ¬í˜„ì„ í•˜ê¸° ì „ì— ë„í˜•ì˜ ì›€ì§ì„ì„ íŒŒì•…í•˜ê³  ë¬¼ë¦¬ì—”ì§„ì„ ë§Œë“œëŠ” ê²ƒë¶€í„°ê°€ ë‚œê´€ì´ì—ˆë‹¤.
í•˜ì§€ë§Œ ì°¨ê·¼ì°¨ê·¼íˆ ì •ë³´ë¥¼ ëª¨ìœ¼ê³  êµ¬í˜„ì„ í•˜ë‹ˆ ì¬ë°Œê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆë‹¤.

# ğŸ“Œ Matter.jsë€?

Matter.jsëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ë¬¼ë¦¬ì—”ì§„ì„ êµ¬í˜„í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.
ë¬¼ì§ˆì€ ì˜ì–´ë¡œ Matterì´ê³  í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì´ê²ƒì„ ì˜ë„í•œ ê²ƒ ê°™ë‹¤.
ê°•ì²´ì˜ ë¬¼ë¦¬ì ì¸ íŠ¹ì„±ì„ ì½”ë“œë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒ ìì²´ê°€ ê²½ì´ë¡­ë‹¤.

# ğŸ“Œ Matter.js & lodash ì„¤ì¹˜
ë¨¼ì € Matter.jsì™€ lodashë¥¼ ì„¤ì¹˜í•´ì¤€ë‹¤.
lodashëŠ” array, collection, date ë“± ë°ì´í„°ì˜ í•„ìˆ˜ì ì¸ êµ¬ì¡°ë¥¼ ì‰½ê²Œ ë‹¤ë£° ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.
íŠ¹íˆ ì½”ë“œë¥¼ ì¤„ì—¬ì£¼ê³ , ë¹ ë¥¸ ì‘ì—…ì— ë„ì›€ì´ ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë¯€ë¡œ ì¸ê¸°ê°€ ë§ë‹¤. 
ë‚˜ëŠ” debounceë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ lodashë¥¼ ì„¤ì¹˜í–ˆë‹¤.

<div className="bg-gray-50 my-4 px-4 py-2 border-l-4 border-green-400 hover:bg-gray-100 hover:border-indigo-400 transition duration-300 ease-in-out">
yarn add @types/matter-js @types/lodash or yarn add matter-js lodash
</div>

# ğŸ“Œ Matter.js ì‚¬ìš©
ë¨¼ì € ë‚˜ëŠ” MatterCompositionë¼ëŠ” Componentë¥¼ ë§Œë“¤ì–´ì„œ Sectionì„ êµ¬ì„±í–ˆë‹¤.
ì „ì²´ ì½”ë“œë¥¼ ë¨¼ì € ì‚´í´ë³´ë„ë¡ í•˜ì.

```tsx
import { useCallback, useEffect, useRef } from 'react'
import { Engine, Render, Bodies, World, Runner } from 'matter-js'
import { debounce } from 'lodash'
import { rainbow } from 'constants/constant'

function MatterComposition() {
  const scene = useRef<HTMLDivElement>(null)
  const engine = useRef(Engine.create())
  const isIntersecting = useRef(false)

  const handleScroll = useCallback(([entry]: IntersectionObserverEntry[]) => {
    const { current } = scene
    if (entry.isIntersecting && current) {
      // ì›í•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€ í•  ê²ƒ
      current.style.transitionProperty = 'opacity'
      current.style.transitionDuration = '1s'
      current.style.transitionTimingFunction = 'cubic-bezier(0, 0, 0.2, 1)'
      current.style.transitionDelay = '0s'
      current.style.opacity = '1'

      if (!isIntersecting.current) {
        const cw = window.innerWidth
        // ë„í˜•ì„ ê³„ì† ì¶”ê°€í•˜ëŠ” ë¶€ë¶„
        World.add(engine.current.world, [
          Bodies.circle(Math.random() * cw, 0, 150, {
            render: { fillStyle: rainbow[0] },
            frictionAir: 0.05,
          }),
        ])
        isIntersecting.current = true
      }
    }
  }, [])

  useEffect(() => {
    const cw = window.innerWidth
    const ch = window.innerHeight

    let render = Render.create({
      element: scene.current ?? new HTMLDivElement(),
      engine: engine.current,
      options: {
        width: cw,
        height: ch,
        wireframes: false,
        background: 'transparent',
      },
    })

    World.add(engine.current.world, [
      Bodies.rectangle(cw / 2, 0, cw, 20, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(0, ch / 2, 20, ch, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(cw / 2, ch, cw, 20, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(cw, ch / 2, 20, ch, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
    ])
    Runner.run(engine.current)
    Render.run(render)

    const handleResize = debounce(() => {
      Render.stop(render)
      World.clear(engine.current.world, false)
      Engine.clear(engine.current)
      render.canvas.remove()

      const cw = window.innerWidth
      const ch = window.innerHeight

      render = Render.create({
        element: scene.current ?? new HTMLDivElement(),
        engine: engine.current,
        options: {
          width: cw,
          height: ch,
          wireframes: false,
          background: 'transparent',
        },
      })

      World.add(engine.current.world, [
        Bodies.rectangle(cw / 2, 0, cw, 20, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
        Bodies.rectangle(0, ch / 2, 20, ch, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
        Bodies.rectangle(cw / 2, ch, cw, 20, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
        Bodies.rectangle(cw, ch / 2, 20, ch, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
      ])

      Runner.run(engine.current)
      Render.run(render)

      isIntersecting.current = false
    }, 1000)

    window.addEventListener('resize', handleResize)

    return () => {
      Render.stop(render)
      World.clear(engine.current.world, false)
      Engine.clear(engine.current)
      render.canvas.remove()
      window.removeEventListener('resize', handleResize)
      isIntersecting.current = false
    }
  }, [])

  useEffect(() => {
    let observer: IntersectionObserver
    const { current } = scene

    if (current) {
      observer = new IntersectionObserver(handleScroll, { threshold: 0.8 })
      observer.observe(current)

      return () => observer && observer.disconnect()
    }
  }, [handleScroll])

  return (
    <div className="w-full h-full">
      <div ref={scene} style={{ width: '100vw', height: '100vh' }} />
    </div>
  )
}

export default MatterComposition
```


# ğŸ“Œ ì½”ë“œ íŒŒí—¤ì¹˜ê¸°
ë³€ìˆ˜ ì„ ì–¸ê³¼ ë¦¬í„´ ë¶€ë¶„ì„ ì‚´í´ë³´ì.
    
```tsx
const scene = useRef<HTMLDivElement>(null)
const engine = useRef(Engine.create())
const isIntersecting = useRef(false)

...

return (
    <div className="w-full h-full">
        <div ref={scene} style={{ width: '100vw', height: '100vh' }} ></div>
    </div>
)
```

Renderë¥¼ êµ¬í˜„í•˜ê³  ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ sceneì„ useRefë¡œ ì´ˆê¸°í™”í•˜ê³ ,
div íƒœê·¸ì— refì— í• ë‹¹í–ˆë‹¤.
engineì€ Matter Engineì„ ìƒì„± í›„ useRefì— ë‹´ì•„ ì´ˆê¸°í™”í–ˆê³ ,
ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì˜ ë°˜ë³µì„ ë§‰ê¸° ìœ„í•œ isIntersectingì€ falseë¥¼ useRefì— ë‹´ì•„ ì´ˆê¸°í™”í–ˆë‹¤.
    
```tsx
    useEffect(() => {
    const cw = window.innerWidth
    const ch = window.innerHeight

    let render = Render.create({
      element: scene.current ?? new HTMLDivElement(),
      engine: engine.current,
      options: {
        width: cw,
        height: ch,
        wireframes: false,
        background: 'transparent',
      },
    })

    World.add(engine.current.world, [
      Bodies.rectangle(cw / 2, 0, cw, 20, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(0, ch / 2, 20, ch, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(cw / 2, ch, cw, 20, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(cw, ch / 2, 20, ch, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
    ])
    Runner.run(engine.current)
    Render.run(render)

    const handleResize = debounce(() => {
      Render.stop(render)
      World.clear(engine.current.world, false)
      Engine.clear(engine.current)
      render.canvas.remove()

      const cw = window.innerWidth
      const ch = window.innerHeight

      render = Render.create({
        element: scene.current ?? new HTMLDivElement(),
        engine: engine.current,
        options: {
          width: cw,
          height: ch,
          wireframes: false,
          background: 'transparent',
        },
      })

      World.add(engine.current.world, [
        Bodies.rectangle(cw / 2, 0, cw, 20, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
        Bodies.rectangle(0, ch / 2, 20, ch, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
        Bodies.rectangle(cw / 2, ch, cw, 20, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
        Bodies.rectangle(cw, ch / 2, 20, ch, {
          isStatic: true,
          render: { fillStyle: '#000000' },
        }),
      ])

      Runner.run(engine.current)
      Render.run(render)

      isIntersecting.current = false
    }, 1000)

    window.addEventListener('resize', handleResize)

    return () => {
      Render.stop(render)
      World.clear(engine.current.world, false)
      Engine.clear(engine.current)
      render.canvas.remove()
      window.removeEventListener('resize', handleResize)
      isIntersecting.current = false
    }
  }, [])
```
ë‹¤ìŒì€ useEffectë¥¼ í†µí•´ ì´ˆê¸°í™”ë¥¼ ì§„í–‰í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.

```tsx
const cw = window.innerWidth
const ch = window.innerHeight

let render = Render.create({
    element: scene.current ?? new HTMLDivElement(),
    engine: engine.current,
    options: {
    width: cw,
    height: ch,
    wireframes: false,
    background: 'transparent',
    },
})
```

window ê°ì²´ì˜ innerWidthì™€ innerHeightë¥¼ í†µí•´ ë¸Œë¼ìš°ì €ì˜ ê°€ë¡œ, ì„¸ë¡œ ê¸¸ì´ë¥¼ êµ¬í•˜ê³ ,
ì´ë¥¼ ê°ê° cwì™€ chì— í• ë‹¹í–ˆë‹¤.
ê·¸ í›„ Render.createë¥¼ í†µí•´ renderë¥¼ ì´ˆê¸°í™”í–ˆë‹¤.

ì—¬ê¸°ì„œ ì¡°ê¸ˆ í—·ê°ˆë¦¬ëŠ” ë¶€ë¶„ì´ ìˆëŠ”ë°, ë¹„ë¡œ ì—”ì§„ê³¼ ë Œë”ì˜ ì°¨ì´ì ì´ë‹¤.
ì—”ì§„ì€ ë¬¼ë¦¬ì—”ì§„ì´ê³ , ë Œë”ëŠ” ì—”ì§„ì„ í†µí•´ ë¬¼ë¦¬ì—”ì§„ì´ ê³„ì‚°í•œ ê²°ê³¼ë¥¼ ì‹¤ì œë¡œ ë³´ì—¬ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.
ë Œë”ëŠ” scene ê°ì²´ë¥¼ í†µí•´ ë Œë”ë§í•  ê³µê°„ì„ ì§€ì •í•´ì£¼ê³ , engine ê°ì²´ë¥¼ í†µí•´ ë¬¼ë¦¬ì—”ì§„ì„ ì§€ì •í•´ì¤€ë‹¤.

```tsx
    World.add(engine.current.world, [
      Bodies.rectangle(cw / 2, 0, cw, 20, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(0, ch / 2, 20, ch, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(cw / 2, ch, cw, 20, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
      Bodies.rectangle(cw, ch / 2, 20, ch, {
        isStatic: true,
        render: { fillStyle: '#000000' },
      }),
    ])
    Runner.run(engine.current)
    Render.run(render)
```

ì´ì œëŠ” Worldë¥¼ í†µí•´ ë¬¼ë¦¬ì—”ì§„ì— ì¶”ê°€í•  ê°ì²´ë“¤ì„ ì¶”ê°€í•´ì¤€ë‹¤.
WorldëŠ” ì—”ì§„ì— ì¶”ê°€ë˜ëŠ” ê°ì²´ë“¤ì˜ ì§‘í•©ì²´ì´ë‹¤.
ê·¸ë¦¬ê³  Bodies ê°ì²´ë¥¼ í†µí•´ ë¬¼ë¦¬ì—”ì§„ì— ì¶”ê°€í•  ê°ì²´ë“¤ì„ ìƒì„±í•´ì¤€ë‹¤.
BodiesëŠ” ë¬¼ë¦¬ì—”ì§„ì— ì¶”ê°€í•  ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê°ì²´ì´ë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ Runnerë¥¼ í†µí•´ ì—”ì§„ì„ ì‹¤í–‰ì‹œí‚¤ê³ , Renderë¥¼ í†µí•´ ë Œë”ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.

```tsx
const handleResize = debounce(() => {
    Render.stop(render)
    World.clear(engine.current.world, false)
    Engine.clear(engine.current)
    render.canvas.remove()

    ...

    Runner.run(engine.current)
    Render.run(render)

    isIntersecting.current = false
}, 1000)
```

ì´ì œëŠ” ë¸Œë¼ìš°ì €ì˜ í¬ê¸°ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë Œë”ë¥¼ ì¤‘ì§€, ì—”ì§„ ì´ˆê¸°í™”, ë Œë”ë¥¼ ë‹¤ì‹œ ì‹¤í–‰ì‹œí‚¤ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
ê·¸ë¦¬ê³  handleResizeëŠ” 1ì´ˆë§ˆë‹¤ ì‹¤í–‰ë˜ë„ë¡ debounceë¥¼ ì‚¬ìš©í–ˆë‹¤.
ìŠ¤í¬ë¡¤ ë³€ê²½ ì‹œ 1ì´ˆê°€ ì§€ë‚œ ì‹œì ì— ê°’ì„ í™•ì¸í•´ ì„±ëŠ¥ì„ ê°œì„ í•˜ê¸° ìœ„í•¨ì´ë‹¤.

```tsx
window.addEventListener('resize', handleResize)

return () => {
    Render.stop(render)
    World.clear(engine.current.world, false)
    Engine.clear(engine.current)
    render.canvas.remove()
    window.removeEventListener('resize', handleResize)
    isIntersecting.current = false
}
```

ìœˆë„ìš° addEventListenerë¥¼ í†µí•´ resize ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ handleResize í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ í–ˆë‹¤.
ê·¸ë¦¬ê³  useEffectì˜ returnì—ëŠ” ì–¸ë§ˆìš´íŠ¸ ë˜ëŠ” ì‹œì ì— ëª¨ë“  ì‘ì—…ì„ ì •ë¦¬í•´ì£¼ëŠ” ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.

```tsx
useEffect(() => {
    let observer: IntersectionObserver
    const { current } = scene

    if (current) {
    observer = new IntersectionObserver(handleScroll, { threshold: 0.8 })
    observer.observe(current)

    return () => observer && observer.disconnect()
    }
}, [handleScroll])
```

ë‹¤ìŒì€ ë¶€ê°€ì ì´ì§€ë§Œ IntersectionObserver ê°ì²´ë¥¼ í™œìš©í•´
sceneì˜ threshold ì‹œì ì„ íŒŒì•…í•´ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ì½”ë“œì´ë‹¤.
IntersectionObserver ê°ì²´ì— ëŒ€í•´ì„œëŠ” ë‚˜ì¤‘ì— í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¤ë£¨ê² ì§€ë§Œ,
ì´ë¦„ì—ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´ êµì°¨ì ì„ ê°ì§€í•˜ëŠ” ê°ì²´ì´ë‹¤.
returnê°’ì€ ì–¸ë§ˆìš´íŠ¸ ì‹œì ì— observerë¥¼ í•´ì œí•´ì¤€ë‹¤.

```tsx
const handleScroll = useCallback(([entry]: IntersectionObserverEntry[]) => {
    const { current } = scene
    if (entry.isIntersecting && current) {
      // ì›í•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€ í•  ê²ƒ
      current.style.transitionProperty = 'opacity'
      current.style.transitionDuration = '1s'
      current.style.transitionTimingFunction = 'cubic-bezier(0, 0, 0.2, 1)'
      current.style.transitionDelay = '0s'
      current.style.opacity = '1'

      if (!isIntersecting.current) {
        const cw = window.innerWidth
        // ë„í˜•ì„ ê³„ì† ì¶”ê°€í•˜ëŠ” ë¶€ë¶„
        World.add(engine.current.world, [
          Bodies.circle(Math.random() * cw, 0, 150, {
            render: { fillStyle: rainbow[0] },
            frictionAir: 0.05,
          }),
        ])
        isIntersecting.current = true
      }
    }
  }, [])
```

ë„˜ê²¨ë°›ì€ entryë¥¼ í†µí•´ isIntersectingì´ trueì¼ ë•Œ ì›í•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.
isIntersectingì€ thresholdê°€ 0.8ì´ê¸° ë•Œë¬¸ì— ì„ê³„ì ì´ 80%ê°€ ë˜ëŠ” ì‹œì ì— trueê°€ ë˜ê³ ,
ê·¸ì™¸ì—ëŠ” falseê°€ ëœë‹¤.
ì¶”ê°€ë¡œ isIntersectingì´ falseì¼ ë•Œë§Œ World.addë¥¼ í†µí•´ ë„í˜•ì„ ì¶”ê°€í•´ì¤€ë‹¤.
ì´ì œ entryì˜ isIntersectingì´ trueê°€ ë˜ë©´ ë„í˜•ì´ ì¶”ê°€ë˜ê³ ,
isIntersectingì„ trueë¡œ ì´ˆê¸°í™” í•´ì£¼ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ ë„í˜•ì´ ì¶”ê°€ë˜ì§€ ì•ŠëŠ”ë‹¤.

# ğŸ˜† ê²°ê³¼ í™•ì¸

<div className="flex justify-center items-center py-5">
  <img src="https://imagedelivery.net/6qzLODAqs2g1LZbVYqtuQw/fa6742a9-f428-4ccb-2581-fb3e630a5a00/public" alt="spring"/>
</div>

















